Absolutely, Vineeth â€” let's now rewrite the **complete and precise instruction** for the `AutoSecure-RefactorAgent`, crafted specifically for a hackathon-winning use case. This version ensures:

* âœ… It **reads OWASP Markdown reports** properly
* âœ… Tries to **fix vulnerabilities + deprecated APIs**
* âœ… Clearly **tells what it fixed and what it couldnâ€™t fix**
* âœ… Simulates **post-fix vulnerability counts and fix %**
* âœ… Provides a **structured, readable report for judges/users**

---

## ğŸ” Final Instruction for `AutoSecure-RefactorAgent`

### ğŸ§¾ Use this exact instruction in the Bedrock Agent:

---

### ğŸ”¹ Agent Name: `AutoSecure-RefactorAgent`

### ğŸ”¸ Agent Instruction:

> You are an AI-powered Java code remediation assistant.
>
> You will receive a **vulnerability scan report** in **Markdown or plain text format**, usually generated by OWASP Dependency-Check. The report includes:
>
> * Total number of vulnerabilities (High, Medium, Low)
> * Vulnerable libraries with CVEs and severity
> * Deprecated Java and Spring APIs
>
> Your task is to:
>
> #### ğŸ›  1. Parse the vulnerability report and understand:
>
> * The **total number of vulnerabilities**, broken down by severity
> * The **list of vulnerable libraries** (e.g., spring-web, log4j, jackson-databind)
> * The **list of deprecated APIs** (e.g., `java.util.Date`, `RestTemplate`, `javax.servlet`)
>
> #### ğŸ”§ 2. Apply code fixes:
>
> * Suggest **upgraded library versions** based on CVEs or common best practices
> * Recommend safe alternatives for deprecated APIs (e.g., `WebClient` for `RestTemplate`)
> * You donâ€™t need to write full code or edit the actual repo â€” just describe the fixes

> #### ğŸ“Š 3. Report back:
>
> Return a **clean Markdown report** that includes:
>
> * âœ… A list of **fixes you applied**
> * â— A list of **vulnerabilities or APIs you could NOT fix**, if any
> * ğŸ“ List of updated files (e.g., `pom.xml`, `App.java`, `DateUtil.java`)
> * ğŸ“‰ A **simulated vulnerability summary table**, showing:
>
>   * Total vulnerabilities before
>   * Vulnerabilities fixed
>   * Estimated vulnerabilities remaining
>   * Fix percentage (e.g., 82%)
>
> If a fix is skipped or not possible (e.g., no newer version or no API alternative), include it in a separate **"Unresolved Items"** section.
>
> Respond only in **Markdown format**.

---

## ğŸ” What the agent will generate (expected format)

Hereâ€™s an example response you should see from this instruction:

---

```markdown
# âœ… AutoSecure Refactor Summary

### ğŸ”§ Fixes Applied

- Upgraded `spring-boot-actuator:2.2.2.RELEASE` â†’ `2.7.15`
- Upgraded `spring-web:5.2.2.RELEASE` â†’ `6.0.9`
- Replaced `RestTemplate` with `WebClient`
- Migrated `java.util.Date` â†’ `java.time.LocalDateTime`
- Replaced `javax.servlet.http.HttpServlet` â†’ `jakarta.servlet.http.HttpServlet`

### ğŸ“ Files Updated

- `pom.xml`
- `AppConfig.java`
- `DateUtil.java`
- `ServletController.java`

---

### â— Unresolved Items

- `commons-io:2.6`: No safe upgrade path known (CVE-2021-29425)
- `org.yaml:snakeyaml`: Could not verify upgrade for `1.25` (potential regressions)

---

### ğŸ” Simulated Vulnerability Summary

| Severity | Before | Fixed | Remaining |
|----------|--------|-------|-----------|
| High     | 5      | 4     | 1         |
| Medium   | 21     | 19    | 2         |
| Low      | 12     | 10    | 2         |

ğŸ¯ **Fix Rate:** 89%

---

### ğŸ“ Notes

- The project is now mostly compliant with Java 17 and Spring Boot 3.
- Remaining issues need manual validation or test coverage to upgrade safely.
```

---

## ğŸ§ª Agent Input Format You Should Send

```json
{
  "scan_report": "## Vulnerability Summary\n| High | 5 | Medium | 21 | Low | 12 |\n\n## Top Vulnerable Dependencies\nspring-web:5.2.2.RELEASE (CVE-2021-22118)\ncommons-io:2.6 (CVE-2021-29425)\n\n## Deprecated APIs Found\njavax.servlet.* â†’ Jakarta\njava.util.Date â†’ java.time"
}
```

---

## âœ… Summary of What This Instruction Ensures

| Capability                          | Covered? |
| ----------------------------------- | -------- |
| Reads OWASP Markdown report         | âœ… Yes    |
| Parses library versions + CVEs      | âœ… Yes    |
| Suggests updated versions           | âœ… Yes    |
| Suggests fixes for deprecated APIs  | âœ… Yes    |
| Handles unfixable issues gracefully | âœ… Yes    |
| Simulates fix % and remaining       | âœ… Yes    |
| Formats clean report in Markdown    | âœ… Yes    |

---

Would you like me to:

* ğŸ¯ Help fine-tune example prompts?
* ğŸ› ï¸ Build a pre-filled test case for Claude/Bedrock with this input?
* ğŸ§  Help write a Lambda to convert OWASP JSON â†’ Markdown if needed?

Just say: **"Give me the test agent input + mock"** and Iâ€™ll generate it immediately.
